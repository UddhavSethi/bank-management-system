<!-- policies.html -->
<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Policies — Apex Bank Management System</title>
	<meta name="description" content="Browse and invest in bank policies.">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/transaction_history.css') }}">
</head>
<body>
	<div class="bg" aria-hidden="true">
		<span class="bubble b1"></span>
		<span class="bubble b2"></span>
		<span class="bubble b3"></span>
		<span class="bubble b4"></span>
		<span class="bubble b5"></span>
		<span class="bubble b6"></span>
	</div>

	<header class="site-header" role="banner">
		<nav class="nav" aria-label="Primary">
			<a class="brand" href="/" aria-label="Apex Bank home">
				<svg class="logo" width="28" height="28" viewBox="0 0 48 48" aria-hidden="true">
					<defs>
						<linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
							<stop offset="0%" stop-color="#7ec8e3"/>
							<stop offset="100%" stop-color="#9be3c7"/>
						</linearGradient>
					</defs>
					<circle cx="24" cy="24" r="20" fill="url(#g)"></circle>
					<path d="M12 28 L24 14 L36 28" fill="none" stroke="#0b3a4a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M17 28 V34 H31 V28" fill="none" stroke="#0b3a4a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
				</svg>
				<span class="brand-name">Apex Bank</span>
			</a>
			<div class="user-info">
				<span class="welcome">Welcome, <strong>{{ username }}</strong></span>
				<div class="nav-links">
					<a href="/dashboard" class="nav-link">Dashboard</a>
					<a href="/logout" class="logout-btn" aria-label="Logout">
						<svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
							<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							<polyline points="16,17 21,12 16,7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							<line x1="21" y1="12" x2="9" y2="12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
						</svg>
						Logout
					</a>
				</div>
			</div>
		</nav>
	</header>

	<main class="main" role="main">
		<section class="transaction-history" aria-labelledby="policies-title">
			<div class="container">
				<div class="page-header">
					<h1 id="policies-title">Policies</h1>
					<p class="lead">Invest in up to two policies. Choose wisely.</p>
				</div>

				<div class="card account-overview" role="region" aria-label="Account overview">
					<div class="account-header">
						<h2>Your Account</h2>
						<div class="account-number">Account: {{ account_number }}</div>
					</div>
					<div class="balance-section">
						<div class="balance-label">Current Balance</div>
						<div class="balance-amount">${{ "%.2f"|format(balance) }}</div>
					</div>
				</div>

				<div class="card summary" role="region" aria-label="Your policies">
					<h2>Your Policies</h2>
					{% if user_policies and user_policies|length > 0 %}
						<div class="summary-grid">
							{% for p in user_policies %}
							<div class="summary-item">
								<div class="summary-label">{{ p.name }}</div>
								<div class="summary-value">Risk: {{ p.risk_level }} — {{ '%.1f'|format(p.expected_return) }}%</div>
							</div>
							{% endfor %}
						</div>
					{% else %}
						<p>You haven't invested in any policies yet.</p>
					{% endif %}
				</div>

				<div class="card transactions" role="region" aria-label="Available policies">
					<div class="transactions-header">
						<h2>Available Policies</h2>
					</div>
					<div class="transactions-list">
						{% for policy in policies %}
						<form class="transaction-item" method="POST">
							<div class="transaction-content" style="width:100%">
								<div class="transaction-header">
									<div class="transaction-title">{{ policy.name }}</div>
									<div class="transaction-amount received">{{ '%.1f'|format(policy.expected_return) }}%</div>
								</div>
								<div class="transaction-details">
									<div class="transaction-description">
										{{ policy.description or '—' }} — Risk: {{ policy.risk_level }}
									</div>
									<div class="transaction-meta">
										<span>Min Investment: ${{ '%.2f'|format(policy.min_investment or 0) }}</span>
										{% if policy.lock_in %}<span> | Lock-in: {{ policy.lock_in }}</span>{% endif %}
										{% if policy.liquidity %}<span> | Liquidity: {{ policy.liquidity }}</span>{% endif %}
									</div>
									{% if policy.goal %}
									<div class="transaction-description">Goal: {{ policy.goal }}</div>
									{% endif %}
									<input type="hidden" name="policy_id" value="{{ policy.id }}">
									<div class="transaction-meta">
										<button class="btn btn-primary" type="submit">Invest</button>
									</div>
								</div>
							</div>
						</form>
						{% endfor %}
					</div>
				</div>
			</div>
		</section>
	</main>

	<footer class="site-footer" role="contentinfo">
		<small>&copy; <span id="year"></span> Apex Bank Management System.</small>
	</footer>

	{% with messages = get_flashed_messages(with_categories=true) %}
		{% if messages %}
			<div class="flash-messages">
				{% for category, message in messages %}
					<div class="flash flash-{{ category }}" role="alert">
						<span>{{ message }}</span>
						<button class="flash-close" aria-label="Close message">&times;</button>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	{% endwith %}
</body>
</html>

